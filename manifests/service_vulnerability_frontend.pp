# == Class: iop::service_vulnerability_frontend
#
# Install and configure the Vulnerability frontend assets
#
# === Parameters:
#
# $image::  The container image
#
# $ensure:: Ensure frontend asserts are present or absent
#
class iop::service_vulnerability_frontend (
  String[1] $image = 'quay.io/iop/vulnerability-frontend:foreman-3.16',
  Enum['present', 'absent'] $ensure = 'present',
) {
  include podman
  ensure_resource('file', '/var/lib/foreman/public/assets/apps', { 'ensure' => 'directory' })

  podman::image { 'service_vulnerability_frontend':
    ensure   => $ensure,
    image    => $image,
    exec_env => ['REGISTRY_AUTH_FILE=/etc/foreman/registry-auth.json'],
  }

  iop_frontend { '/var/lib/foreman/public/assets/apps/vulnerability':
    ensure  => $ensure,
    image   => $image,
    require => Podman::Image['service_vulnerability_frontend'],
  }
}
